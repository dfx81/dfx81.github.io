<!doctype html>
<html>
<head>
<title>A*</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*
{
    margin: 0px;
    padding: 0px;
}
</style>
<script>
var c, ctx, tile = 100, start = 0, end = 11;
var check = [];

var nodes = [
{x: 0, y: 0, index: 0, global: -1, local: -1, parent: -1},
{x: 1, y: 0, index: 1, global: -1, local: -1, parent: -1},
{x: 2, y: 0, index: 2, global: -1, local: -1, parent: -1},
{x: 3, y: 0, index: 3, global: -1, local: -1, parent: -1},
{x: 0, y: 1, index: 4, global: -1, local: -1, parent: -1},
{x: 1, y: 1, index: 5, global: -1, local: -1, parent: -1},
{x: 2, y: 1, index: 6, global: -1, local: -1, parent: -1},
{x: 3, y: 1, index: 7, global: -1, local: -1, parent: -1},
{x: 0, y: 2, index: 8, global: -1, local: -1, parent: -1},
{x: 1, y: 2, index: 9, global: -1, local: -1, parent: -1},
{x: 2, y: 2, index: 10, global: -1, local: -1, parent: -1},
{x: 3, y: 2, index: 11, global: -1, local: -1, parent: -1}];

var map = [
"F", "F", "F", "F",
"F", "F", "F", "F",
"F", "F", "F", "F"];

window.onload = function()
{
    c = document.getElementById("c");
    c.addEventListener("click", remap);
    ctx = c.getContext("2d");
    
    if (window.sessionStorage.getItem("map") != null)
        for (i = 0; i != map.length; i++)
            map[i] = window.sessionStorage.getItem("map").charAt(i);
    
    window.requestAnimationFrame(update);
};

function remap(evt)
{
    if ((Math.floor(evt.clientX / tile) + Math.floor(evt.clientY / tile) * 4) != start && (Math.floor(evt.clientX / tile) + Math.floor(evt.clientY / tile) * 4) != end)
    map[Math.floor(evt.clientX / tile) + Math.floor(evt.clientY / tile) * 4] = (map[Math.floor(evt.clientX / tile) + Math.floor(evt.clientY / tile) * 4] == "W") ? "F" : "W";
    
    var newMap = "";
    
    for (i = 0; i != map.length; i++)
        newMap += map[i];
    
    window.sessionStorage.setItem("map", newMap);
    
    window.location.reload();
}

function update()
{
    var log = document.getElementById("log");
    
    check.push(start);
    
    log.innerHTML = "Start: " + start + " | Goal: " + end + "<br/><br/>";
    log.innerHTML += check + "<br/>";
    
    nodes[start].global = nodes[end].x - nodes[start].x + nodes[end].y - nodes[start].y;
    nodes[start].local = 0;
    
    ctx.fillStyle = "black";
    ctx.fillRect(0, 0, c.width, c.height);
    
    for (y = 0; y != 3; y++)
        for (x = 0; x != 4; x++)
        {
            ctx.fillStyle = (map[x + y * 4] == "W") ? "black": "white";
            ctx.fillRect(x * tile + 1, y * tile + 1, tile - 2, tile - 2);
        }
    
    while (check.length > 0)
    {
        var i = check[0];
        var x = nodes[i].x;
        var y = nodes[i].y;
        
        if (y - 1 >= 0)
        if (map[x + (y - 1) * 4] != "W")
        {
            if (nodes[i].global + 1 < nodes[x + (y - 1) * 4].local || nodes[x + (y - 1) * 4].local == -1)
            {
                nodes[x + (y - 1) * 4].parent = i;
                nodes[x + (y - 1) * 4].local = nodes[i].global + 1;
                nodes[x + (y - 1) * 4].global = nodes[end].x - nodes[x + (y - 1) * 4].x + nodes[end].y - nodes[x + (y - 1) * 4].y + nodes[x + (y - 1) * 4].local;
                check.push(x + (y - 1) * 4);
            }
        }
        
        if (x - 1 >= 0)
        if (map[(x - 1) + y * 4] != "W")
        {
            if (nodes[i].global + 1 < nodes[(x - 1) + y * 4].local || nodes[(x - 1) + y * 4].local == -1)
            {
                nodes[(x - 1) + y * 4].parent = i;
                nodes[(x - 1) + y * 4].local = nodes[i].global + 1;
                nodes[(x - 1) + y * 4].global = nodes[end].x - nodes[(x - 1) + y * 4].x + nodes[end].y - nodes[(x - 1) + y * 4].y + nodes[(x - 1) + y * 4].local;
                check.push((x - 1) + y * 4);
            }
        }
        
        if (x + 1 < 4)
        if (map[(x + 1) + y * 4] != "W")
        {
            if (nodes[i].global + 1 < nodes[(x + 1) + y * 4].local || nodes[(x + 1) + y * 4].local == -1)
            {
                nodes[(x + 1) + y * 4].parent = i;
                nodes[(x + 1) + y * 4].local = nodes[i].global + 1;
                nodes[(x + 1) + y * 4].global = nodes[end].x - nodes[(x + 1) + y * 4].x + nodes[end].y - nodes[(x + 1) + y * 4].y + nodes[(x + 1) + y * 4].local;
                check.push((x + 1) + y * 4);
            }
        }
        
        if (y + 1 < 3)
        if (map[x + (y + 1) * 4] != "W")
        {
            if (nodes[i].global + 1 < nodes[x + (y + 1) * 4].local || nodes[x + (y + 1) * 4].local == -1)
            {
                nodes[x + (y + 1) * 4].parent = i;
                nodes[x + (y + 1) * 4].local = nodes[i].global + 1;
                nodes[x + (y + 1) * 4].global = nodes[end].x - nodes[x + (y + 1) * 4].x + nodes[end].y - nodes[x + (y + 1) * 4].y + nodes[x + (y + 1) * 4].local;
                check.push(x + (y + 1) * 4);
            }
        }
        
        check.splice(0, 1);
        log.innerHTML += check + "<br/>";
    }
    
    ctx.fillStyle = "blue";
    
    var path = end;
    if (nodes[end].parent != -1)
    while (path != -1)
    {
        ctx.fillRect(nodes[path].x * tile + 1, nodes[path].y * tile + 1, tile - 2, tile - 2);
        path = nodes[path].parent;
    }
}
</script>
</head>
<body>
<canvas width="400" height="300" id="c"></canvas>
<p id="log"></p>
</body>
</html>